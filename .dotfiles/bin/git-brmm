#!/usr/bin/env zsh
# Split on space, not only \n.
setopt localoptions shwordsplit

# Get default branch if any, default to master
BASE_BRANCH=$(git config --get custom.defaultBranch || echo master)
DELETABLE_BRANCHES=$(git branch --merged=$BASE_BRANCH | cut -c3- | grep -v $BASE_BRANCH)

if [[ -z "$DELETABLE_BRANCHES" ]]; then
  echo "No merged branches to delete"
else
  for b in $DELETABLE_BRANCHES; do
    git branch -d "$b"
  done
fi

# vim: syntax=zsh
